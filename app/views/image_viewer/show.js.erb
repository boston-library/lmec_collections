<%# Based on from https://github.com/boston-library/commonwealth-vlr-engine/blob/18fc91c/app/views/image_viewer/show.js.erb %>

// add a class so the thumbnail is highlighted
$('#thumbnail_list').find('a').each(function() {
    if ($(this).hasClass('in_viewer')) {
        $(this).removeClass('in_viewer');
    }
    if ($(this).data('viewer') === '<%= @page_sequence[:current] %>') {
        $(this).addClass('in_viewer');
    }
});

// update the image pagination
$('#page_sequence').replaceWith("<%= escape_javascript(render :partial => 'catalog/_show_partials/show_multi_img_pagination',
                   :locals => {:page_sequence => @page_sequence}) %>");

// update the main image
$('#img_show_container').replaceWith("<%= escape_javascript(render :partial => 'catalog/_show_partials/show_default_img',
                                                :locals => {:image_key => @page_sequence[:current_key],
                                                            :document => @document,
                                                            :page_sequence => @page_sequence}) %>");

$('#img_show_container')
    .find('img')
        .load(function() {
            $('#img_show_container')
                .css('height', $('#img_show_container').outerHeight());
        });
